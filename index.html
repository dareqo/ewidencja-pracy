<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ewidencja czasu pracy</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      margin: 0;
      background: #f8f9fa;
    }

    h1 {
      font-size: 24px;
      text-align: center;
      margin-bottom: 20px;
    }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    button {
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
    }

    button:hover {
      background: #0056b3;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 6px;
      overflow: hidden;
    }

    th, td {
      padding: 10px;
      text-align: center;
      border: 1px solid #dee2e6;
    }

    th {
      background-color: #f1f3f5;
    }

    @media (max-width: 600px) {
      th, td {
        font-size: 14px;
        padding: 8px;
      }

      button {
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>

  <h1>Ewidencja czasu pracy</h1>

  <div class="buttons">
    <button id="startBtn" onclick="startWork()">‚ñ∂Ô∏è Start</button>
    <button id="stopBtn" onclick="stopWork()">‚èπÔ∏è Zako≈Ñcz</button>
    <button onclick="exportCSV()">‚¨áÔ∏è Eksportuj CSV</button>
    <button onclick="clearLogs()">üßπ Wyczy≈õƒá historiƒô</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Data</th>
        <th>Start</th>
        <th>Koniec</th>
        <th>Czas pracy (min)</th>
      </tr>
    </thead>
    <tbody id="logBody"></tbody>
  </table>

  <script>
    function startWork() {
      const now = new Date().toISOString();
      localStorage.setItem("startTime", now);
      updateButtons();
    }

    function stopWork() {
      const start = localStorage.getItem("startTime");
      if (!start) {
        alert("Nie rozpoczƒÖ≈Çe≈õ pracy.");
        return;
      }

      const startTime = new Date(start);
      const endTime = new Date();
      const duration = Math.round((endTime - startTime) / 60000); // w minutach

      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${startTime.toLocaleDateString()}</td>
        <td>${startTime.toLocaleTimeString()}</td>
        <td>${endTime.toLocaleTimeString()}</td>
        <td>${duration}</td>
      `;
      document.getElementById("logBody").appendChild(row);

      const logs = JSON.parse(localStorage.getItem("logs") || "[]");
      logs.push({
        date: startTime.toLocaleDateString(),
        start: startTime.toLocaleTimeString(),
        end: endTime.toLocaleTimeString(),
        duration: duration
      });
      localStorage.setItem("logs", JSON.stringify(logs));

      localStorage.removeItem("startTime");
      updateButtons();
    }

    function exportCSV() {
      const logs = JSON.parse(localStorage.getItem("logs") || "[]");
      if (logs.length === 0) {
        alert("Brak danych do eksportu.");
        return;
      }

      const csvRows = [
        ["Data", "Start", "Koniec", "Czas pracy (min)"],
        ...logs.map(log => [log.date, log.start, log.end, log.duration])
      ];
      const csvContent = csvRows.map(e => e.join(",")).join("\n");
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = "ewidencja.csv";
      a.click();
      URL.revokeObjectURL(url);
    }

    function clearLogs() {
      if (confirm("Na pewno chcesz usunƒÖƒá ca≈ÇƒÖ historiƒô?")) {
        localStorage.removeItem("logs");
        localStorage.removeItem("startTime");
        document.getElementById("logBody").innerHTML = "";
        updateButtons();
        alert("Historia zosta≈Ça usuniƒôta.");
      }
    }

    function updateButtons() {
      const started = localStorage.getItem("startTime");
      document.getElementById("startBtn").style.display = started ? "none" : "inline-block";
      document.getElementById("stopBtn").style.display = started ? "inline-block" : "none";
    }

    function loadTable() {
      const logs = JSON.parse(localStorage.getItem("logs") || "[]");
      const tbody = document.getElementById("logBody");
      tbody.innerHTML = "";
      logs.forEach(log => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${log.date}</td>
          <td>${log.start}</td>
          <td>${log.end}</td>
          <td>${log.duration}</td>
        `;
        tbody.appendChild(row);
      });
    }

    window.onload = () => {
      updateButtons();
      loadTable();
    };
  </script>
</body>
</html>
